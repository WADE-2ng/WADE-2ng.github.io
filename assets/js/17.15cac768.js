(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{496:function(t,s,n){"use strict";n.r(s);var a=n(1),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("本篇博客主要是对cobaltstrike的学习总结\n")]),t._v(" "),s("h2",{attrs:{id:"cs服务器端部署位置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cs服务器端部署位置"}},[t._v("#")]),t._v(" CS服务器端部署位置：")]),t._v(" "),s("p",[t._v("cd /usr/CS/cobaltstrike4.3/cobaltstrike4.3")]),t._v(" "),s("p",[t._v("启动：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./teamserver "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("114.132")]),t._v(".124.214 "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("passwd")]),t._v("\n")])])]),s("h3",{attrs:{id:"screen使用-解决云服务器分shell问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#screen使用-解决云服务器分shell问题"}},[t._v("#")]),t._v(" screen使用（解决云服务器分shell问题）：")]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[t._v("screen  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("创建新命令界面，并在此开启teamserver\nctrl "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("a+d "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("退出当前shell，进入主shell\nscreen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("查看分任务列表\nscreen "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("r 任务编号进入任务\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exit")]),t._v(" \t"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("在分任务中执行，退出且关闭分任务一切进程\n")])])]),s("h2",{attrs:{id:"主机上线信息收集阶段-前置shell命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主机上线信息收集阶段-前置shell命令"}},[t._v("#")]),t._v(" 主机上线信息收集阶段(前置shell命令):")]),t._v(" "),s("div",{staticClass:"language-powershell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[t._v("ipconfig "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("all\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#主机ip")]),t._v("\n\nsysteminfo "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#操作系统版本 | 补丁列表")]),t._v("\n\nwmic product get name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("version\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#安装软件版本、路径")]),t._v("\n\nwmic service list brief\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#服务信息查询")]),t._v("\n\ntasklist "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v\twmic "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("process")]),t._v(" list brief\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#进程查询")]),t._v("\n\nwmic startup get command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("caption\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动项")]),t._v("\n\nnet statistics workstation "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#开机时间")]),t._v("\n······································································\nwmic脚本工具 wmic_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rar 已上传\n······································································\n\n\n\n······································································\n\nnet user "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#用户信息")]),t._v("\n\nnet localgroup administrators \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获取本地管理员或用户信息")]),t._v("\n\nquery user "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" qwinsta "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看当前在线用户 winserver还有，7，10无")]),t._v("\n\nnet session "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 本地与客户端会话")]),t._v("\n\n·······································································\n\nnetstat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ano "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#端口信息")]),t._v("\n\nnet share "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#本机共享列表")]),t._v("\n\nroute print "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#路由表")]),t._v("\n\narp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("a "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#arp缓存表")]),t._v("\n\n·······································································\n\nnetsh firewall show config "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看防火墙配置")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#实现防火墙开启关闭 ")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server2003 之后\nnetsh advfirewall "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),t._v(" allprofiles state on \n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("server2003 之前\nnetsh firewall "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),t._v(" opmode disable "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#关闭")]),t._v("\nnetsh firewall "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),t._v(" opmode mode=enable "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#开启")]),t._v("\n\n\n·······································································\n\nwhoami "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#获取域SID")]),t._v("\n\nnet user XXX "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("domain "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#指定用户详细信息")]),t._v("\n\n·······································································\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#判断是否存在域：")]),t._v("\nipconfig/all\n\nnslookup 反差dns ip与域控是否一致\n\nnet config workstation "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查当前登录域信息")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#检查 当前用户是否为域用户")]),t._v("\n\nnet time "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("domain\n拒绝访问\t不为域用户\n返回time \t  存在且为域用户\n找不到域控\t不存在域  ································判断域是否存在\n\n·······································································\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#域内存活主机检测\t工具在靶机win7桌面 上传git-tools （工具\\Neiwang）")]),t._v("\n1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("NetBIOS\nnbtscan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe 内网网段 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#扫描内网网段 ")]),t._v("\n\n2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arp-scan\narp-scan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t 网段  不是很好用，建议结合netscan使用s\n\n3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("主机ping\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("L "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("I in "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("254"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DO")]),t._v(" @ping "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("w 1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("n 1 192"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("52"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v("I "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v(" findstr "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TTL="')]),t._v("\n来自 192"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("52"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("138 的回复: 字节=32 时间<1ms TTL=128\n来自 192"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("52"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("143 的回复: 字节=32 时间<1ms TTL=128\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#端口扫描")]),t._v("\n4"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ScanLine "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tcp、udp扫描"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exe "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t 22"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("80-89"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("110"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("445"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("139"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("389 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u 53"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("161 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("o "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("txt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p 192"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("168"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("244"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1-254\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t tcp端口 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("u udp \n\n5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CS上线端口扫描\n")])])]),s("h2",{attrs:{id:"域信息收集"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#域信息收集"}},[t._v("#")]),t._v(" 域信息收集")]),t._v(" "),s("p",[t._v("域信息收集：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查询域：")]),t._v("\nnet view /domain\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#域内所有计算机")]),t._v("\nnet view /domain:GOD\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查询所有用户信息")]),t._v("\nwmic useraccount get /all\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#存在用户信息：都是域管理工具，必须在windows server服务器上才有，")]),t._v("\ndsquery user\n")])])]),s("h2",{attrs:{id:"上线web服务器后的横向移动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上线web服务器后的横向移动"}},[t._v("#")]),t._v(" 上线web服务器后的横向移动")]),t._v(" "),s("blockquote",[s("p",[t._v("1.提权至system")]),t._v(" "),s("p",[t._v("2.创建Beacon SMB 监听器")]),t._v(" "),s("p",[t._v("3.在system主机上进行新建会话，指定SMB监听。")]),t._v(" "),s("p",[t._v("4.在system主机"),s("strong",[t._v("SMB监听")]),t._v("上进行 net view ,查找在线内网主机")]),t._v(" "),s("p",[t._v("5.在目标机器上进行横向渗透，选择SMB监听，选择"),s("strong",[t._v("GOD.org")]),t._v("域下用户名密码。")]),t._v(" "),s("p",[t._v("6.上线。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);