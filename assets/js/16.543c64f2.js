(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{495:function(s,a,t){"use strict";t.r(a);var r=t(1),e=Object(r.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("本篇博客主要是对应急响应知识的学习总结，包括Windows和Linux平台。")]),s._v(" "),a("h1",{attrs:{id:"hw应急响应面试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hw应急响应面试"}},[s._v("#")]),s._v(" HW应急响应面试")]),s._v(" "),a("h2",{attrs:{id:"一、linux排查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、linux排查"}},[s._v("#")]),s._v(" 一、Linux排查")]),s._v(" "),a("h3",{attrs:{id:"_1-检查登录信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-检查登录信息"}},[s._v("#")]),s._v(" 1.检查登录信息：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("/etc/passwd "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#检查一般登录信息 ，涉及登陆用户名")]),s._v("\n/etc/shadow "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#检查登陆密码")]),s._v("\n")])])]),a("h3",{attrs:{id:"_2-查看历史命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-查看历史命令"}},[s._v("#")]),s._v(" 2.查看历史命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /home/.bash_history "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看")]),s._v("\n")])])]),a("h3",{attrs:{id:"_3-检查异常端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-检查异常端口"}},[s._v("#")]),s._v(" 3.检查异常端口")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -antlp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#返回pid值以及文件路径")]),s._v("\n")])])]),a("h3",{attrs:{id:"_4-检查异常进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-检查异常进程"}},[s._v("#")]),s._v(" 4.检查异常进程")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" pid\n")])])]),a("h4",{attrs:{id:"杀进程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#杀进程"}},[s._v("#")]),s._v(" 杀进程：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  /  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("killall")]),s._v(" 进程名\n")])])]),a("h3",{attrs:{id:"_5-检查开机启动项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-检查开机启动项"}},[s._v("#")]),s._v(" 5.检查开机启动项")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl list-unit-files \n")])])]),a("h3",{attrs:{id:"_6-检查定时服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-检查定时服务"}},[s._v("#")]),s._v(" 6.检查定时服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n")])])]),a("h3",{attrs:{id:"_7-服务检查及其关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-服务检查及其关闭"}},[s._v("#")]),s._v(" 7.服务检查及其关闭")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--list")]),s._v("  /  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" 服务名 off/on\n")])])]),a("h3",{attrs:{id:"_8-检查日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-检查日志"}},[s._v("#")]),s._v(" 8.检查日志")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("/etc/log \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#几个常用文件夹 ")]),s._v("\nutmp当前登陆状态用户\tlastlog每个用户最后登录信息\tbtmp错误登录尝试记录\twtmp登录成功信息  \n")])])]),a("h3",{attrs:{id:"_9-检查用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-检查用户"}},[s._v("#")]),s._v(" 9.检查用户")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("who")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#返回pts->远程\ttty->本地登录 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("who")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" 查看当前登录用户ip\n")])])]),a("h3",{attrs:{id:"_1-linux应急相应靶场解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-linux应急相应靶场解析"}},[s._v("#")]),s._v(" （1）Linux应急相应靶场解析")]),s._v(" "),a("h4",{attrs:{id:"_1-网络连接排查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-网络连接排查"}},[s._v("#")]),s._v(" 1.网络连接排查")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-anpt")]),s._v("\n")])])]),a("h4",{attrs:{id:"_2-查找问题程序位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-查找问题程序位置"}},[s._v("#")]),s._v(" 2.查找问题程序位置")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h4",{attrs:{id:"_3-查询文件创建时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-查询文件创建时间"}},[s._v("#")]),s._v(" 3.查询文件创建时间")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" 文件名\n")])])]),a("h4",{attrs:{id:"_4-取恶意文件-将疑似恶意文件放入例如-微步云沙箱-进行检测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-取恶意文件-将疑似恶意文件放入例如-微步云沙箱-进行检测"}},[s._v("#")]),s._v(" 4.取恶意文件，将疑似恶意文件放入例如 微步云沙箱（）进行检测")]),s._v(" "),a("h4",{attrs:{id:"_5-排查历史命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-排查历史命令"}},[s._v("#")]),s._v(" 5.排查历史命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("    /\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" _bash.history"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看管理员权限下的命令")]),s._v("\n")])])]),a("h4",{attrs:{id:"_6-排查当前用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-排查当前用户"}},[s._v("#")]),s._v(" 6.排查当前用户")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("who")]),s._v("\n")])])]),a("h4",{attrs:{id:"_7-查看特权账户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-查看特权账户"}},[s._v("#")]),s._v(" 7.查看特权账户")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$3==0 {print$1}'")]),s._v(" /etc/passwd\n")])])]),a("h4",{attrs:{id:"_8-远程登陆账号信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-远程登陆账号信息"}},[s._v("#")]),s._v(" 8.远程登陆账号信息")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/\\$1|\\$6/{print $1}'")]),s._v(" /etc/shadow\n")])])]),a("h4",{attrs:{id:"_9-历史登录信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-历史登录信息"}},[s._v("#")]),s._v(" 9.历史登录信息")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Accepted "')]),s._v(" /var/log/secure* "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print $1,$2,$3,$9,$11}'")]),s._v("\n")])])]),a("h4",{attrs:{id:"_10-查找定时服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-查找定时服务"}},[s._v("#")]),s._v(" 10.查找定时服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/spool/cron\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" root\n")])])]),a("h4",{attrs:{id:"_11-检查命令文件是否被替换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-检查命令文件是否被替换"}},[s._v("#")]),s._v(" 11.检查命令文件是否被替换")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/bin\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Vf")]),s._v(" *\n")])])]),a("blockquote",[a("p",[s._v("被替换关键字：")]),s._v(" "),a("p",[s._v("S ---\x3e文件大小变化")]),s._v(" "),a("p",[s._v("5----\x3emd5值发生变化")]),s._v(" "),a("p",[s._v("T----\x3e 文件时间变化")])]),s._v(" "),a("h4",{attrs:{id:"检查被替换命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检查被替换命令"}},[s._v("#")]),s._v(" 检查被替换命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-al")]),s._v(" 命令\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" 命令\n")])])]),a("h4",{attrs:{id:"命令备份位置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令备份位置"}},[s._v("#")]),s._v(" 命令备份位置")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(".hide_command/命令\t\n")])])]),a("h4",{attrs:{id:"恶意命令删除及其覆盖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恶意命令删除及其覆盖"}},[s._v("#")]),s._v(" 恶意命令删除及其覆盖")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /usr/bin/命令\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /.hide_command/命令 /usr/bin/命令\n")])])]),a("h4",{attrs:{id:"_12-删除后门用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-删除后门用户"}},[s._v("#")]),s._v(" 12.删除后门用户")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/passwd\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除恶意用户")]),s._v("\n")])])]),a("h4",{attrs:{id:"_13-溯源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-溯源"}},[s._v("#")]),s._v(" 13.溯源")]),s._v(" "),a("p",[s._v("查看恶意文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" shell.elf "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#以下都是查看创建时间")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" 定时任务\t\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" 命令替换\n")])])]),a("h4",{attrs:{id:"_14-查看安全日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-查看安全日志"}},[s._v("#")]),s._v(" 14.查看安全日志")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" secure"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" Failed\n")])])]),a("h2",{attrs:{id:"二、linux基线规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、linux基线规范"}},[s._v("#")]),s._v(" 二、Linux基线规范")]),s._v(" "),a("p",[s._v("1.账号管理")]),s._v(" "),a("p",[s._v("检查特殊账号，是否存在空密码以及root权限的账户")]),s._v(" "),a("p",[s._v("禁用或删除无用账号")]),s._v(" "),a("p",[s._v("添加口令：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("/etc/login.defs "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改配置文件，设置过期时间和连续认证失败次数")]),s._v("\n")])])]),a("p",[s._v("禁止root远程登陆，限制root用户直接登录")]),s._v(" "),a("p",[s._v("检查su权限")]),s._v(" "),a("p",[s._v("2.服务：")]),s._v(" "),a("p",[s._v("关闭不必要的服务")]),s._v(" "),a("p",[s._v("修改SSH使用的协议版本为2，修改允许密码错误次数为3（默认为6）")]),s._v(" "),a("p",[s._v("3.文件系统 设置登录超时")]),s._v(" "),a("p",[s._v("4.日志")]),s._v(" "),a("p",[s._v("启用syslogd日志，==记录所有用户的登录和操作日志==")]),s._v(" "),a("h2",{attrs:{id:"三、windows安全基线检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、windows安全基线检查"}},[s._v("#")]),s._v(" 三、Windows安全基线检查")]),s._v(" "),a("h3",{attrs:{id:"_1-身份鉴别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-身份鉴别"}},[s._v("#")]),s._v(" 1.身份鉴别")]),s._v(" "),a("p",[s._v("更改缺省账户，将其用户名重命名为Administrator")]),s._v(" "),a("p",[s._v("检查guest用户是否被禁用，禁用操作")]),s._v(" "),a("p",[s._v("启用密码必须符合复杂性要求，长度不小于8位")]),s._v(" "),a("p",[s._v("静态口令认证生存期不少于90天，不能重复使用最近5次之内的口令，静态口令认证失败次数不超过6次")]),s._v(" "),a("h3",{attrs:{id:"_2-访问控制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-访问控制"}},[s._v("#")]),s._v(" 2.访问控制")]),s._v(" "),a("p",[s._v("共享账户检查、远程关机授权、本地关机、授权账户登录")]),s._v(" "),a("h3",{attrs:{id:"_3-安全审计-应用、安全、系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-安全审计-应用、安全、系统"}},[s._v("#")]),s._v(" 3.安全审计（应用、安全、系统）")]),s._v(" "),a("p",[s._v("用户登录日志记录、系统日志完备性检查、登录超时管理")]),s._v(" "),a("h3",{attrs:{id:"_4-剩余信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-剩余信息"}},[s._v("#")]),s._v(" 4.剩余信息")]),s._v(" "),a("p",[s._v("不显示上次登录用户名")]),s._v(" "),a("p",[s._v("关机清除虚拟内存页面")]),s._v(" "),a("p",[s._v("不启用可还原的加密来存储密码")]),s._v(" "),a("h2",{attrs:{id:"四、中间件规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、中间件规范"}},[s._v("#")]),s._v(" 四、中间件规范")]),s._v(" "),a("h3",{attrs:{id:"_1-配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-配置"}},[s._v("#")]),s._v(" 1.配置")]),s._v(" "),a("p",[s._v("账号，授权、日志、session过期时间、绑定监听地址")]),s._v(" "),a("h3",{attrs:{id:"_2-禁止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-禁止"}},[s._v("#")]),s._v(" 2.禁止")]),s._v(" "),a("p",[s._v("目录权限、访问外部文件、CGI、非法http访问：PUT、DELETE")]),s._v(" "),a("h3",{attrs:{id:"_3、隐藏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、隐藏"}},[s._v("#")]),s._v(" 3、隐藏")]),s._v(" "),a("p",[s._v("服务版本号、重定向错误页面")]),s._v(" "),a("h3",{attrs:{id:"_4-删除配置文件及默认的安装无用文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-删除配置文件及默认的安装无用文件"}},[s._v("#")]),s._v(" 4.删除配置文件及默认的安装无用文件")]),s._v(" "),a("h2",{attrs:{id:"五、服务器安全加固"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、服务器安全加固"}},[s._v("#")]),s._v(" 五、服务器安全加固")]),s._v(" "),a("h3",{attrs:{id:"步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),a("h4",{attrs:{id:"禁止root用户直接登陆"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁止root用户直接登陆"}},[s._v("#")]),s._v(" 禁止root用户直接登陆")]),s._v(" "),a("div",{staticClass:"language-swift extra-class"},[a("pre",{pre:!0,attrs:{class:"language-swift"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 编辑配置文件"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sshd_config 修改"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PermitRootLogin")]),s._v(" 后面的yes 为 no "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("并且去掉前面的注释符\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("编辑 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("pam"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("login文件，配置auth "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("required")]),s._v(" pam_securetty"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("编辑"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("passwd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("账户信息的shell为"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nologin的为禁止远程登陆，如要允许，则改成可以登陆的shell即可，如"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bash。\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("然后重启sshd服务 service sshd restart\n")])])]),a("h4",{attrs:{id:"设置用户密码复杂度和过期时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置用户密码复杂度和过期时间"}},[s._v("#")]),s._v(" 设置用户密码复杂度和过期时间")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("是在/etc/login.defs文件，里面几个选项\nPASS_MAX_DAYS   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#密码最长过期天数")]),s._v("\nPASS_MIN_DAYS   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#密码最小过期天数")]),s._v("\nPASS_MIN_LEN    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#密码最小长度")]),s._v("\nPASS_WARN_AGE   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#密码过期警告天数")]),s._v("\n")])])]),a("h4",{attrs:{id:"登陆超时设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登陆超时设置"}},[s._v("#")]),s._v(" 登陆超时设置")]),s._v(" "),a("div",{staticClass:"language-undefined extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/etc/profile最后一行加入TMOUT=300\n")])])]),a("h4",{attrs:{id:"系统关键文件权限设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系统关键文件权限设置"}},[s._v("#")]),s._v(" 系统关键文件权限设置")]),s._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[s._v("通过chmod命令对目录的权限进行实际设置\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("passwd 必须所有用户都可读，root用户可写 –rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r—r— \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shadow 只有root可读 –r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v("  须所有用户都可读，root用户可写 –rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r—r—\n使用如下命令设置：\nchmod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("644")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("passwd\nchmod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("shadow\nchmod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("644")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v("\n")])])]),a("h4",{attrs:{id:"设置文件与目录缺省权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置文件与目录缺省权限"}},[s._v("#")]),s._v(" 设置文件与目录缺省权限")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("在文件/etc/profile中设置umask 027或UMASK 027\n设置默认权限： \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/login.defs， \n在末尾增加umask 027或UMASK 027，将缺省访问权限设置为750\n")])])]),a("h4",{attrs:{id:"设置ssh登录前警告banner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置ssh登录前警告banner"}},[s._v("#")]),s._v(" 设置ssh登录前警告Banner")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".  执行如下命令创建ssh banner信息文件： \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#touch /etc/ssh_banner ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#chown bin:bin /etc/ssh_banner ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#chmod 644 /etc/ssh_banner ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#echo " Authorized only. All activity will be monitored and reported "> /etc/ssh_banner ')]),s._v("\n可根据实际需要修改该文件的内容。 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".  修改/etc/ssh/sshd_config文件，添加如下行： \nBanner /etc/ssh_banner \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".  重启sshd服务： \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/etc/init.d/sshd restart ")]),s._v("\n")])])]),a("h4",{attrs:{id:"设置文件与目录缺省权限-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置文件与目录缺省权限-2"}},[s._v("#")]),s._v(" 设置文件与目录缺省权限")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("在文件/etc/profile中设置umask 027或UMASK 027\n设置默认权限： \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/login.defs， \n在末尾增加umask 027或UMASK 027，将缺省访问权限设置为750\n如果服务器类型为采集服务器或应用中需要使用ftp的，需要设置umask为007，并把ftp用户组和启动应用的用户设置为同一用户组下\n")])])]),a("h4",{attrs:{id:"修改ssh默认端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改ssh默认端口"}},[s._v("#")]),s._v(" 修改ssh默认端口")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/ssh/sshd_config 修改")]),s._v("\nPort "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17382")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#service sshd restart")]),s._v("\n")])])]),a("h4",{attrs:{id:"限制用户su到root"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#限制用户su到root"}},[s._v("#")]),s._v(" 限制用户su到root")]),s._v(" "),a("div",{staticClass:"language-csharp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-csharp"}},[a("code",[s._v("编辑su文件"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vi "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("pam"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("su"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("，在开头添加下面两行： \nauth sufficient pam_rootok"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so 和 \nauth required "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("pam_wheel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wheel 这表明只有wheel组的成员可以使用su命令成为root用户。 \n你可以把用户添加到wheel组，以使它可以使用su命令成为root用户。 \n添加方法为：usermod –G wheel username\n备注：双方共同运维服务器，且root密码为我方知晓时设置\n")])])]),a("h4",{attrs:{id:"检查拥有suid和sgid权限的文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检查拥有suid和sgid权限的文件"}},[s._v("#")]),s._v(" 检查拥有suid和sgid权限的文件")]),s._v(" "),a("div",{staticClass:"language-rust extra-class"},[a("pre",{pre:!0,attrs:{class:"language-rust"}},[a("code",[s._v("执行命令"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \nfind "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("chage "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gpasswd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("wall "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("chfn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("chsh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("newgrp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("write "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usernetctl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("traceroute "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("umount "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ping "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("netreport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token type-definition class-name"}},[s._v("f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("perm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("04000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("perm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("02000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token type-definition class-name"}},[s._v("f")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("xdev "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("null \n如果存在输出结果，则使用chmod "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" 文件名 命令修改文件的权限。 \n例如：chmod a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("chage\n")])])]),a("p",[s._v("注:所有软件最好用最新版本.\n还对ftp端口进行了修改，防火墙注释掉对21 22端口的放行。vsp使用的是被动模式，开放出了高端位端口，目前还未进行安全扫描，后续根据扫描结果会继续修改本文。")]),s._v(" "),a("h2",{attrs:{id:"六、常见漏洞解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、常见漏洞解析"}},[s._v("#")]),s._v(" 六、常见漏洞解析")]),s._v(" "),a("p",[s._v("redis未授权访问")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("（1）redis绑定在 0.0.0.0:6379，且没有进行添加防火墙规则避免其他非信任来源ip访问等相关安全策略，直接暴露在公网；\n（2）没有设置密码认证（一般为空），可以免密码远程登录redis服务。 \n")])])]),a("p",[s._v("利用：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("（1）攻击者无需认证访问到内部数据，可能导致敏感信息泄露，黑客也可以恶意执行flushall来清空所有数据；\n（2）攻击者可通过EVAL执行lua代码，或通过数据备份功能往磁盘写入后门文件；\n（3）最严重的情况，如果Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);